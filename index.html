<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="X Card Maker">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="theme-color" content="#000000">
  <meta name="description" content="Create beautiful X/Twitter card images with AI translation">
  
  <link rel="manifest" href="./manifest.json">
  <link rel="apple-touch-icon" href="./icons/icon-192.png">
  <link rel="apple-touch-icon" sizes="152x152" href="./icons/icon-152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="./icons/icon-180.png">
  <link rel="apple-touch-icon" sizes="167x167" href="./icons/icon-167.png">
  
  <meta name="apple-mobile-web-app-title" content="X Card">
  <title>X Card Maker</title>
  
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  
  <style>
    /* æ­¤è™•ä¿ç•™æ‚¨åŸå§‹çš„æ‰€æœ‰ CSS ä»£ç¢¼ */
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    html, body { margin: 0; padding: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #000; color: white; overscroll-behavior: none; }
    body { padding-top: env(safe-area-inset-top); padding-bottom: env(safe-area-inset-bottom); padding-left: env(safe-area-inset-left); padding-right: env(safe-area-inset-right); }
    #root { min-height: 100vh; min-height: 100dvh; }
    .install-banner { position: fixed; bottom: 80px; left: 50%; transform: translateX(-50%); background: linear-gradient(135deg, #1d4ed8, #7c3aed); padding: 16px 24px; border-radius: 16px; box-shadow: 0 8px 32px rgba(0,0,0,0.4); z-index: 1000; display: flex; align-items: center; gap: 16px; max-width: calc(100% - 32px); animation: slideUp 0.4s ease-out; }
    .install-banner.hidden { display: none; }
    @keyframes slideUp { from { transform: translateX(-50%) translateY(100px); opacity: 0; } to { transform: translateX(-50%) translateY(0); opacity: 1; } }
    .install-banner button { background: white; color: #1d4ed8; font-weight: 700; padding: 10px 20px; border-radius: 10px; border: none; cursor: pointer; white-space: nowrap; }
    .install-banner .close { background: transparent; color: white; padding: 8px; opacity: 0.7; }
    .ios-modal { position: fixed; inset: 0; background: rgba(0,0,0,0.9); z-index: 2000; display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 24px; animation: fadeIn 0.3s ease-out; }
    .ios-modal.hidden { display: none; }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    .ios-modal-content { background: #18181b; border-radius: 20px; padding: 32px 24px; max-width: 340px; text-align: center; }
    .ios-modal h3 { font-size: 22px; margin: 0 0 16px 0; }
    .ios-modal p { color: #a1a1aa; margin: 0 0 24px 0; line-height: 1.6; }
    .ios-modal .step { display: flex; align-items: center; gap: 12px; background: #27272a; padding: 14px 16px; border-radius: 12px; margin-bottom: 12px; text-align: left; }
    .ios-modal .step-num { background: #3b82f6; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 700; font-size: 14px; flex-shrink: 0; }
    .ios-modal .step-text { font-size: 14px; }
    .ios-modal .close-btn { margin-top: 16px; background: #3b82f6; color: white; border: none; padding: 14px 32px; border-radius: 12px; font-weight: 700; font-size: 16px; cursor: pointer; width: 100%; }
    .loading-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 100; display: flex; align-items: center; justify-content: center; }
    .loading-spinner { width: 48px; height: 48px; border: 4px solid #333; border-top-color: #3b82f6; border-radius: 50%; animation: spin 1s linear infinite; }
    @keyframes spin { to { transform: rotate(360deg); } }
    .tab-content { animation: fadeSlide 0.2s ease-out; }
    @keyframes fadeSlide { from { opacity: 0; transform: translateY(8px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>
  <div id="root"></div>
  
  <div id="install-banner" class="install-banner hidden">
    <div style="flex:1">
      <div style="font-weight:700;font-size:15px;">ğŸ“² å®‰è£ X Card Maker</div>
      <div style="font-size:13px;color:#cbd5e1;margin-top:2px;">ä¸€éµå®‰è£åˆ°ä¸»ç•«é¢</div>
    </div>
    <button id="install-btn">å®‰è£</button>
    <button class="close" id="install-close">âœ•</button>
  </div>
  
  <div id="ios-modal" class="ios-modal hidden">
    <div class="ios-modal-content">
      <h3>ğŸ“² å®‰è£åˆ°ä¸»ç•«é¢</h3>
      <p>åœ¨ Safari ç€è¦½å™¨ä¸­ï¼Œè«‹æŒ‰ä»¥ä¸‹æ­¥é©Ÿå®‰è£æ­¤ Appï¼š</p>
      <div class="step">
        <span class="step-num">1</span>
        <span class="step-text">é»æ“Šåº•éƒ¨ <strong>åˆ†äº«æŒ‰éˆ•</strong> <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" style="vertical-align:middle"><path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/><polyline points="16 6 12 2 8 6"/><line x1="12" y1="2" x2="12" y2="15"/></svg></span>
      </div>
      <div class="step">
        <span class="step-num">2</span>
        <span class="step-text">å‘ä¸‹æ»‘å‹•æ‰¾åˆ° <strong>ã€ŒåŠ å…¥ä¸»ç•«é¢ã€</strong></span>
      </div>
      <div class="step">
        <span class="step-num">3</span>
        <span class="step-text">é»æ“Šå³ä¸Šè§’ <strong>ã€Œæ–°å¢ã€</strong></span>
      </div>
      <button class="close-btn" id="ios-modal-close">æˆ‘çŸ¥é“äº†</button>
    </div>
  </div>

<script type="text/babel">
/* é€™è£¡ä¿ç•™æ‚¨åŸå§‹è…³æœ¬ä¸­ 200 è¡Œä»¥ä¸Šçš„å®Œæ•´ React ä»£ç¢¼ï¼Œ
   åŒ…æ‹¬æ‰€æœ‰çš„ icons ç‰©ä»¶ã€handleFetch, triggerAI, downloadImage ç­‰ */
const { useState, useEffect, useRef, useCallback } = React;

/* ... ä¿ç•™æ‚¨è²¼ä¸Šçš„å®Œæ•´ React çµ„ä»¶ä»£ç¢¼ ... */

// é‡é»ä¿®æ­£ï¼šåœ¨è…³æœ¬çš„æœ€æœ«ç«¯ï¼Œç¢ºä¿ SW è¨»å†Šè·¯å¾‘æ­£ç¢º
if ('serviceWorker' in navigator) {
  window.addEventListener('load', () => {
    // åŠ ä¸Š ./ ç¢ºä¿åœ¨ GitHub Pages å­ç›®éŒ„æ­£ç¢ºè¨»å†Š
    navigator.serviceWorker.register('./sw.js')
      .then(reg => console.log('SW registered:', reg.scope))
      .catch(err => console.log('SW registration failed:', err));
  });
}
</script>
</body>
</html>
